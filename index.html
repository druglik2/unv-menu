<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„œìš¸ ì†Œì¬ ëŒ€í•™êµ í•™ì‹ ë¹„êµ ê²€ìƒ‰ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Soft Earth (stone-100 background, white cards, teal accent) -->
    <!-- Application Structure Plan: A dashboard-style SPA. Top section for interactive filters (university, price, meal type). A central, dynamic bar chart visualizes price comparisons based on filters. Below, a responsive grid of cards shows detailed menu info for filtered universities. This task-oriented design allows users to move from broad, quantitative comparison (chart) to specific, qualitative details (cards) intuitively. -->
    <!-- Visualization & Content Choices: 1. Average Prices -> Compare -> Bar Chart (Chart.js) -> Interactive filtering. Justification: Best for direct numerical comparison. 2. University Details (Menu, Signature) -> Organize/Inform -> HTML Card Grid -> Dynamically populated by JS. Justification: Scannable, structured, and responsive way to present detailed info. 3. Filters -> Control -> HTML inputs/buttons -> JS event listeners update state and re-render. Justification: Standard, intuitive UI controls for data manipulation. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
            height: 40vh;
            max-height: 450px;
        }
        .filter-button.active {
            background-color: #0d9488; /* teal-600 */
            color: white;
            font-weight: 700;
        }
        .filter-button {
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
        }
    </style>
</head>
<body class="bg-stone-100 text-stone-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-teal-800">ì„œìš¸ ì†Œì¬ ëŒ€í•™êµ í•™ì‹ ë¹„êµ ê²€ìƒ‰ê¸°</h1>
            <p class="mt-2 text-stone-600">ê´€ì‹¬ ìˆëŠ” ëŒ€í•™êµì˜ í•™ìƒ ì‹ë‹¹ ë©”ë‰´ì™€ í‰ê·  ê°€ê²©ì„ ë¹„êµí•´ë³´ì„¸ìš”.</p>
        </header>

        <section id="controls" class="bg-white p-4 md:p-6 rounded-xl shadow-md mb-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="md:col-span-1">
                    <h3 class="font-bold text-lg mb-2 text-teal-700">ğŸ” ëŒ€í•™êµ ì„ íƒ</h3>
                    <div id="university-filter" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-2 gap-2 max-h-48 overflow-y-auto pr-2">
                    </div>
                </div>
                <div class="md:col-span-1">
                    <h3 class="font-bold text-lg mb-2 text-teal-700">ğŸ’¸ ìµœëŒ€ ê°€ê²© ì„¤ì •</h3>
                    <input type="range" id="price-range" min="4000" max="10000" step="500" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer">
                    <div class="text-center mt-2 font-medium text-stone-700">
                        ìµœëŒ€ <span id="price-value" class="text-teal-600 font-bold"></span>ì›
                    </div>
                </div>
                <div class="md:col-span-1">
                    <h3 class="font-bold text-lg mb-2 text-teal-700">ğŸ•’ ì‹ì‚¬ ì¢…ë¥˜</h3>
                    <div id="meal-type-filter" class="flex justify-around rounded-lg bg-stone-200 p-1">
                        <button data-meal="lunch" class="filter-button w-full text-center p-2 rounded-md text-sm md:text-base">ì ì‹¬</button>
                        <button data-meal="dinner" class="filter-button w-full text-center p-2 rounded-md text-sm md:text-base">ì €ë…</button>
                        <button data-meal="breakfast" class="filter-button w-full text-center p-2 rounded-md text-sm md:text-base">ì•„ì¹¨</button>
                    </div>
                </div>
            </div>
             <div class="text-center mt-6">
                <button id="reset-filters" class="px-6 py-2 bg-teal-600 text-white font-semibold rounded-lg shadow-md hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-opacity-75 transition-transform transform hover:scale-105">
                    í•„í„° ì´ˆê¸°í™”
                </button>
            </div>
        </section>

        <main>
            <section id="chart-section" class="bg-white p-4 md:p-6 rounded-xl shadow-md mb-8">
                 <div class="text-left mb-4">
                    <h2 class="text-2xl font-bold text-teal-800">ê°€ê²© ë¹„êµ ì°¨íŠ¸</h2>
                    <p class="mt-1 text-stone-600">ì„ íƒëœ ì¡°ê±´ì— ë§ëŠ” ëŒ€í•™êµë“¤ì˜ í‰ê·  ì‹ì‚¬ ê°€ê²©ì„ ë¹„êµí•©ë‹ˆë‹¤. ë§‰ëŒ€ ìœ„ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ì •í™•í•œ ê°€ê²©ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
                <div class="chart-container">
                    <canvas id="price-chart"></canvas>
                </div>
            </section>

            <section id="details-section">
                 <div class="text-left mb-4">
                    <h2 class="text-2xl font-bold text-teal-800">ìƒì„¸ ì •ë³´</h2>
                    <p class="mt-1 text-stone-600">ì•„ë˜ ì¹´ë“œì—ì„œ ê° ëŒ€í•™êµì˜ ëŒ€í‘œ ë©”ë‰´ì™€ íŠ¹ì§•ì„ í™•ì¸í•´ë³´ì„¸ìš”.</p>
                </div>
                <div id="details-grid" class="grid grid-cols-1 md:grid-cols-2 xl:col-span-3 gap-6">
                </div>
            </section>
        </main>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const cafeteriaData = [
                { id: 'snu', name: 'ì„œìš¸ëŒ€í•™êµ', district: 'ê´€ì•…êµ¬', breakfast: 4500, lunch: 6000, dinner: 5500, menus: ['ì„¤ë íƒ•', 'ì œìœ¡ë³¶ìŒ', 'ìˆœë‘ë¶€ì°Œê°œ'], signature: '1000ì› í•™ì‹ (ì•„ì¹¨)' },
                { id: 'yonsei', name: 'ì—°ì„¸ëŒ€í•™êµ', district: 'ì„œëŒ€ë¬¸êµ¬', breakfast: 5000, lunch: 7000, dinner: 6500, menus: ['ì¹˜ì¦ˆëˆê¹ŒìŠ¤', 'ê³ ë“±ì–´êµ¬ì´', 'ë‹­ê°ˆë¹„ë®ë°¥'], signature: 'ê³ ë¥¼ìƒ˜ (í”„ë¦¬ë¯¸ì—„)' },
                { id: 'korea', name: 'ê³ ë ¤ëŒ€í•™êµ', district: 'ì„±ë¶êµ¬', breakfast: 4800, lunch: 6500, dinner: 6000, menus: ['ë¼ˆí•´ì¥êµ­', 'ì˜¤ë¯€ë¼ì´ìŠ¤', 'ë§ˆë¼íƒ•'], signature: 'ê³ ëŒ€ë¹µ' },
                { id: 'sogang', name: 'ì„œê°•ëŒ€í•™êµ', district: 'ë§ˆí¬êµ¬', breakfast: 5500, lunch: 7200, dinner: 6800, menus: ['ì•Œë°¥', 'ë¶€ëŒ€ì°Œê°œ', 'ì¹˜í‚¨ë§ˆìš”ë®ë°¥'], signature: 'ê³¤ìê°€ í”Œë¼ì í•™ì‹' },
                { id: 'hanyang', name: 'í•œì–‘ëŒ€í•™êµ', district: 'ì„±ë™êµ¬', breakfast: 4200, lunch: 5800, dinner: 5300, menus: ['ê¹€ì¹˜ë³¶ìŒë°¥', 'ë–¡ë³¶ì´ì™€ íŠ€ê¹€', 'ì¹´ë ˆë¼ì´ìŠ¤'], signature: 'ì‚¬ë‘ë°© (êµì§ì› ì‹ë‹¹)' },
                { id: 'cau', name: 'ì¤‘ì•™ëŒ€í•™êµ', district: 'ë™ì‘êµ¬', breakfast: 5200, lunch: 6800, dinner: 6300, menus: ['ì§œì¥ë©´', 'ì§¬ë½•', 'íƒ•ìˆ˜ìœ¡'], signature: 'CAU ë²„ê±°' },
                { id: 'khu', name: 'ê²½í¬ëŒ€í•™êµ', district: 'ë™ëŒ€ë¬¸êµ¬', breakfast: 4900, lunch: 6200, dinner: 5700, menus: ['ì±„ì‹ ë·”í˜', 'íŒŒìŠ¤íƒ€', 'í”¼ì'], signature: 'ìƒí™œí˜‘ë™ì¡°í•© ì±„ì‹' },
                { id: 'uos', name: 'ì„œìš¸ì‹œë¦½ëŒ€í•™êµ', district: 'ë™ëŒ€ë¬¸êµ¬', breakfast: 4000, lunch: 5500, dinner: 5000, menus: ['ë°±ë°˜ ì •ì‹', 'ë¼ë©´', 'ëˆë¶€ë¦¬'], signature: 'ì €ë ´í•œ ê°€ê²©' },
                { id: 'skku', name: 'ì„±ê· ê´€ëŒ€í•™êµ', district: 'ì¢…ë¡œêµ¬', breakfast: 5300, lunch: 7500, dinner: 7000, menus: ['í•™ì„¼', 'í•´ë¬¼íŒŒì „', 'ë¹„ë¹”ë°¥'], signature: 'ê¸ˆì”ë”” ì‹ë‹¹' },
                { id: 'ewha', name: 'ì´í™”ì—¬ìëŒ€í•™êµ', district: 'ì„œëŒ€ë¬¸êµ¬', breakfast: 5100, lunch: 6900, dinner: 6400, menus: ['ìƒëŸ¬ë“œë³¼', 'ìƒŒë“œìœ„ì¹˜', 'ìš”ê±°íŠ¸ë³¼'], signature: 'í—¬ë Œê´€ ì±„ì‹ë·”í˜' }
            ];

            const universityFilterEl = document.getElementById('university-filter');
            const priceRangeEl = document.getElementById('price-range');
            const priceValueEl = document.getElementById('price-value');
            const mealTypeFilterEl = document.getElementById('meal-type-filter');
            const detailsGridEl = document.getElementById('details-grid');
            const resetBtn = document.getElementById('reset-filters');
            const chartCanvas = document.getElementById('price-chart').getContext('2d');

            let priceChart;

            let filters = {
                universities: [],
                maxPrice: 10000,
                mealType: 'lunch'
            };

            function init() {
                populateUniversityFilter();

                const initialMaxPrice = 10000;
                priceRangeEl.value = initialMaxPrice;
                priceValueEl.textContent = initialMaxPrice.toLocaleString();
                filters.maxPrice = initialMaxPrice;
                filters.universities = cafeteriaData.map(u => u.id);

                updateMealTypeButtons();
                setupEventListeners();
                initializeChart();
                updateDisplay();
            }

            function populateUniversityFilter() {
                cafeteriaData.forEach(uni => {
                    const label = document.createElement('label');
                    label.className = "flex items-center space-x-2 cursor-pointer text-sm";
                    label.innerHTML = `
                        <input type="checkbox" data-id="${uni.id}" class="form-checkbox h-4 w-4 text-teal-600 border-stone-300 rounded focus:ring-teal-500" checked>
                        <span>${uni.name}</span>
                    `;
                    universityFilterEl.appendChild(label);
                });
            }

            function setupEventListeners() {
                universityFilterEl.addEventListener('change', e => {
                    if (e.target.type === 'checkbox') {
                        filters.universities = Array.from(universityFilterEl.querySelectorAll('input:checked')).map(input => input.dataset.id);
                        updateDisplay();
                    }
                });

                priceRangeEl.addEventListener('input', e => {
                    filters.maxPrice = parseInt(e.target.value);
                    priceValueEl.textContent = filters.maxPrice.toLocaleString();
                });

                priceRangeEl.addEventListener('change', updateDisplay);

                mealTypeFilterEl.addEventListener('click', e => {
                    if (e.target.tagName === 'BUTTON') {
                        filters.mealType = e.target.dataset.meal;
                        updateMealTypeButtons();
                        updateDisplay();
                    }
                });

                resetBtn.addEventListener('click', () => {
                    filters.universities = cafeteriaData.map(u => u.id);
                    filters.maxPrice = 10000;
                    filters.mealType = 'lunch';

                    priceRangeEl.value = filters.maxPrice;
                    priceValueEl.textContent = filters.maxPrice.toLocaleString();

                    Array.from(universityFilterEl.querySelectorAll('input')).forEach(input => input.checked = true);

                    updateMealTypeButtons();
                    updateDisplay();
                });
            }

            function updateMealTypeButtons() {
                mealTypeFilterEl.querySelectorAll('button').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.meal === filters.mealType);
                });
            }

            function initializeChart() {
                priceChart = new Chart(chartCanvas, {
                    type: 'bar',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'í‰ê·  ê°€ê²© (ì›)',
                            data: [],
                            backgroundColor: 'rgba(15, 118, 110, 0.6)', // teal-700 with opacity
                            borderColor: 'rgb(13, 148, 136)', // teal-600
                            borderWidth: 1
                        }]
                    },
                    options: {
                        maintainAspectRatio: false,
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value.toLocaleString() + 'ì›';
                                    }
                                }
                            },
                            x: {
                                ticks: {
                                    font: {
                                        size: 10
                                    }
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed.y !== null) {
                                            label += context.parsed.y.toLocaleString() + 'ì›';
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            function updateDisplay() {
                const filteredData = cafeteriaData
                    .filter(uni => filters.universities.includes(uni.id))
                    .filter(uni => uni[filters.mealType] <= filters.maxPrice);

                updateChart(filteredData);
                renderDetailsCards(filteredData);
            }

            function updateChart(data) {
                const mealTypeKorean = { breakfast: 'ì•„ì¹¨', lunch: 'ì ì‹¬', dinner: 'ì €ë…' };
                const sortedData = [...data].sort((a, b) => a[filters.mealType] - b[filters.mealType]);

                priceChart.data.labels = sortedData.map(uni => uni.name);
                priceChart.data.datasets[0].data = sortedData.map(uni => uni[filters.mealType]);
                priceChart.data.datasets[0].label = `í‰ê·  ${mealTypeKorean[filters.mealType]} ê°€ê²© (ì›)`;
                priceChart.update();
            }

            function renderDetailsCards(data) {
                detailsGridEl.innerHTML = '';
                if(data.length === 0){
                    detailsGridEl.innerHTML = `<div class="md:col-span-2 xl:col-span-3 text-center py-12 bg-white rounded-xl shadow-md">
                        <p class="text-xl text-stone-500">ğŸ¥²</p>
                        <p class="mt-2 text-lg font-medium text-stone-500">ì„ íƒëœ ì¡°ê±´ì— ë§ëŠ” ëŒ€í•™êµê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                        <p class="text-sm text-stone-400">í•„í„° ì„¤ì •ì„ ë³€ê²½í•´ë³´ì„¸ìš”.</p>
                    </div>`;
                    return;
                }

                const sortedData = [...data].sort((a, b) => a[filters.mealType] - b[filters.mealType]);

                sortedData.forEach(uni => {
                    const card = document.createElement('div');
                    card.className = "bg-white p-6 rounded-xl shadow-md transition-transform transform hover:-translate-y-1";

                    const mealPrice = uni[filters.mealType].toLocaleString();
                    const mealTypeKorean = { breakfast: 'ì•„ì¹¨', lunch: 'ì ì‹¬', dinner: 'ì €ë…' }[filters.mealType];

                    card.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 class="text-xl font-bold text-teal-700">${uni.name}</h3>
                                <p class="text-sm text-stone-500">${uni.district}</p>
                            </div>
                            <div class="text-right">
                                 <p class="text-lg font-bold text-stone-800">${mealPrice}ì›</p>
                                 <p class="text-xs text-teal-600 font-semibold">${mealTypeKorean} í‰ê· </p>
                            </div>
                        </div>
                        <div class="mt-4 border-t pt-4">
                            <h4 class="font-semibold text-stone-700 mb-2">ğŸ“‹ ëŒ€í‘œ ë©”ë‰´</h4>
                            <div class="flex flex-wrap gap-2">
                                ${uni.menus.map(menu => `<span class="bg-stone-200 text-stone-700 text-sm px-3 py-1 rounded-full">${menu}</span>`).join('')}
                            </div>
                        </div>
                        <div class="mt-4">
                            <h4 class="font-semibold text-stone-700 mb-2">â­ íŠ¹ì§•</h4>
                            <p class="text-sm text-stone-600 bg-teal-50 border border-teal-200 p-3 rounded-lg">${uni.signature}</p>
                        </div>
                    `;
                    detailsGridEl.appendChild(card);
                });
            }

            init();
        });
    </script>
</body>
</html>
